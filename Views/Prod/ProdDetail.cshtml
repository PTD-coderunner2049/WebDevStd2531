@model WebDevStd2531.Models.Product
@{
	ViewData["Title"] = Model.Name;
}

@{
	// var mProduct = Model;
}

<ul class="breadcrumb">
	<li>
		<a asp-controller="Home"
		   asp-action="Index">
			Home
		</a> <span class="divider">/</span>
	</li>

	@if (Model.Category?.GrandCategory != null)
	{
		<li><a href="#">@Model.Category.GrandCategory.Name</a> <span class="divider">/</span></li>
	}
	@if (Model.Category != null)
	{
		<li>
			<a asp-controller="Prod"
			   asp-action="CateDetail"
			   asp-route-id="@Model.Category.Id">
				@Model.Category.Name
			</a> <span class="divider">/</span>
		</li>
	}
	<li class="active">@Model.Name</li>
</ul>

<div class="row">
	<div id="gallery" class="span3">
		<a href="@Model.ImageUrl" title="@Model.Name">
			<img src="@Model.ImageUrl" style="width:100%" alt="@Model.Name" />
		</a>
		<div id="differentview" class="moreOptopm carousel slide">
			<div class="carousel-inner">
				<div class="item active">
					<a href="@Model.ImageUrl"> <img style="width:29%" src="@Model.ImageUrl" alt="" /></a>
					<a href="@Model.ImageUrl"> <img style="width:29%" src="@Model.ImageUrl" alt="" /></a>
					<a href="@Model.ImageUrl"> <img style="width:29%" src="@Model.ImageUrl" alt="" /></a>
				</div>
			</div>
		</div>

		<div class="btn-toolbar">
			@* ... static buttons that DO NOT WORK >@v@<... *@
			<div class="btn-group">
				<span class="btn"><i class="icon-envelope"></i></span>
				<span class="btn"><i class="icon-print"></i></span>
				<span class="btn"><i class="icon-zoom-in"></i></span>
				<span class="btn"><i class="icon-star"></i></span>
				<span class="btn"><i class=" icon-thumbs-up"></i></span>
				<span class="btn"><i class="icon-thumbs-down"></i></span>
			</div>
		</div>
	</div>
	<div class="span6">

		<h3>@Model.Name </h3>
		<small>- @Model.Description</small>
		<hr class="soft" />

		@* CORRECTED FORM: Targets the AddCart action and includes all necessary inputs *@
		<form asp-controller="Prod" asp-action="AddCart" method="post" class="form-horizontal qtyFrm">

			@* Hidden input for ProductId (required for AddCart action) *@
			<input type="hidden" name="ProductId" value="@Model.Id" />

			<div class="control-group">
				<label class="control-label"><span>$@Model.Price.ToString("N2")</span></label>
				<div class="controls">

					@* Quantity Input: Name must be 'Quantity' for binding *@
					<input type="number"
						   name="Quantity"
						   class="span1"
						   placeholder="Qty."
						   value="1"
						   min="1"
						   max="@Model.Stock" />

					@* Add to Cart Button *@
					<button type="submit" class="btn btn-large btn-primary pull-right">
						Add to cart <i class=" icon-shopping-cart"></i>
					</button>
				</div>
			</div>

			<hr class="soft" />

			<h4>@Model.Stock items in stock</h4>

			<div class="control-group">
				<label class="control-label"><span>Color</span></label>
				<div class="controls">
					<select name="SelectedType" class="span2">
						@* product's AvailableOptions *@
						@if (Model.AvailableOptions != null && Model.AvailableOptions.Any())
						{
							@foreach (var option in Model.AvailableOptions)
							{
								// Assuming ProductOption has a 'Name' property for the option value/text
								<option value="@option.Value">@option.Value</option>
							}
						}
						else
						{
							// Fallback option if no options are defined
							<option value="Default">N/A (Default)</option>
						}
					</select>
				</div>
			</div>
			<hr class="soft clr" />
		</form>
		@* END OF CORRECTED FORM *@

		<p> @Model.Description </p>
		<a class="btn btn-small pull-right" href="#detail">More Details</a>
		<br class="clr" />
		<a href="#" name="detail"></a>
		<hr class="soft" />
	</div>
	<div class="span9">
		<ul id="productDetail" class="nav nav-tabs">
			<li class="active"><a href="#home" data-toggle="tab">Product Details</a></li>
			<li><a href="#profile" data-toggle="tab">Related Products</a></li>
		</ul>
		<div id="myTabContent" class="tab-content">
			<div class="tab-pane fade active in" id="home">
				<partial name="_ProductDetailsTab" model="Model" />
			</div>
			<div class="tab-pane fade" id="profile">
				<partial name="_relatedProductsTab" model="Model.Category.Products" />
			</div>
		</div>
	</div>
</div>